* forces current values to be saved
.options savecurrents

******************************************
.TRAN 1ms 200ms

.model Default D

* input voltage source
Vin 1 0 0 ac 1.0 sin(0 230 50)

**********************
*n = 200
**********************

*voltage controlled voltage source
E1 3 2 1 0 200

Vaux 2 4 0V
*current controlled current source
F1 1 0 Vaux 200


* MUDAR VALORES DO CAPACITOR E DA RESISTáº¼NCIA
Cenvelope 5 0 1u
Rregulator 5 6 0.5k

Renvelope 5 0 0.5k

Dbridge1 3 5 Default
Dbridge2 4 5 Default
Dbridge3 0 4 Default
Dbridge4 0 3 Default

* positive limiter
Dp1 6 7 Default
Dp2 7 8 Default
Dp3 8 9 Default
Dp4 9 10 Default
Dp5 10 11 Default
Dp6 11 12 Default
Dp7 12 13 Default
Dp8 13 14 Default
Dp9 14 15 Default
Dp10 15 16 Default
Dp11 16 17 Default
Dp12 17 18 Default
Dp13 18 19 Default
Dp14 19 20 Default
Dp15 20 21 Default
Dp16 21 22 Default
Dp17 22 23 Default
Dp18 23 24 Default

.END

.op

.end 

.control

******************************************

*makes plots in color
set hcopypscolor=0
set color0=white
set color1=black
set color2=red
set color3=blue
set color4=violet
set color5=rgb:3/8/0
set color6=rgb:4/0/0

* analise no tempo
tran 1e-5 200e-3

******************************************
hardcopy v_out.ps v(6)
echo v_out_FIG

hardcopy envelope.ps v(5)
echo envelope_FIG

hardcopy regulator.ps v(6) - v(5)
echo regulator_FIG

******************************************
meas tran output AVG v(6)
meas tran max MAX v(6)
meas tran min MIN v(6)

.endc

